<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" sizes="76x76" href="assets/images/olade-logo-blue.png">
    <link rel="icon" type="image/png" href="assets/images/olade-logo-blue.png">
    <!--    font-awesome-->
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">

    <link rel="stylesheet" href="assets/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;0,900;1,300;1,600;1,800&display=swap" rel="stylesheet">
    <title>Candidate Enrollment</title>
</head>
<body>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-4">
            <div class="login-bg text-white">
                <div class="pt-lg-5">
                    <p class="">Find Bright, Diverse And
                        <br>
                        Innovative Tech Talent
                    </p>
                </div>
            </div>

        </div>
        <div class="col-md-8 m-auto">
            <div class="container p-5">
                <div class="float-end">
                    <a href="" id="logo-container"><img src="assets/images/olade-logo-blue.png" width="70" alt=""></a>
                </div>
            </div>

            <div class="login-form ">
                    <h1>Student Enrollment</h1>
                    <form id="withPay" class=" mt-4">
                        <div class="mb-4">
                            <h5>Billing Details</h5>
                        </div>
                        <div class="mb-4 row pr-5">
                            <div class="col-lg-6">
                                <label class="form-label" style="">First Name</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Last Name</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                        </div>
                        <div class="mb-4 row pr-5">
                            <div class="col-lg-6">
                                <label class="form-label" style="">Company Name(optional)</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Country</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>

                        </div>
                        <div class="mb-4 row pr-5">
                            <div class="col-lg-8">
                                <label class="form-label">Address</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-4">
                                <label class="form-label">Phone Number</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                        </div>
                        <div class="mb-4 row pr-5">
                            <div class="col-lg-4">
                                <label class="form-label">Town/city</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-label">Province</label>
                                    <select class="form-control" id="exampleFormControlSelect1">
                                        <option>Lorum Ipsum</option>
                                        <option>Lorum Ipsum</option>
                                        <option>Lorum Ipsum</option>
                                        <option>Lorum Ipsum</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <label class="form-label">Postal Code</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>

                        </div>
<!--                        <div class="mb-4 row">-->
<!--                        -->
<!--                            &lt;!&ndash;                            <div class="col-lg-6">&ndash;&gt;-->
<!--                            &lt;!&ndash;                                <label class="form-label">Company(Optional)</label>&ndash;&gt;-->
<!--                            &lt;!&ndash;                                <input type="text" class="form-control"&ndash;&gt;-->
<!--                            &lt;!&ndash;                                       placeholder="Enter Last name">&ndash;&gt;-->
<!--                            &lt;!&ndash;                            </div>&ndash;&gt;-->
<!--                        </div>-->
                        <div class="mb-4 pt-3">
                            <h5>User Login Details</h5>
                        </div>

                        <div class="mb-4 pr-5 row">
                            <div class="col-lg-6">
                                <label class="form-label">Email Address</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Password</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                        </div>
                        <div class="mb-4 pt-3">
                            <h5>Card Details</h5>
                        </div>

                        <div class="mb-4 pr-5 row">
                            <div class="col-lg-4">
                                <label class="form-label">Card Number</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-4">
                                <label class="form-label">Expiry Date</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                            <div class="col-lg-4">
                                <label class="form-label">CVV</label>
                                <input type="text" class="form-control"
                                       placeholder="">
                            </div>
                        </div>
                        <button type="button" class="btn mt-4 float-end pry-btn mr-5">PLACE ORDER</button>
                    </form>

                    <form id="withoutPay" class=" mt-4">
                        <div class="mb-4">
                            <h5>General Details</h5>
                        </div>
                        <div class="mb-4 row pr-5">
                            <div class="col-lg-6">
                                <label class="form-label">First Name<font color="red">*</font></label>
                                <input type="text" class="form-control" id="fname"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Last Name<font color="red">*</font></label>
                                <input type="text" class="form-control" id="lname"
                                       placeholder="">
                            </div>
                        </div>
                        <div class="mb-4 row pr-5">
                            <div class="col-lg-6">
                                <label class="form-label">Nick Name</label>
                                <input type="text" class="form-control" id="nname"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Email Address<font color="red">*</font></label>
                                <input type="text" class="form-control" id="email"
                                       placeholder="">
                            </div>

                        </div>
                        <div class="mb-4 pt-3">
                            <h5>User Login Details</h5>
                        </div>

                        <div class="mb-4 pr-5 row">
                            <div class="col-lg-6">
                                <label class="form-label">Display Name</label>
                                <input type="text" class="form-control" id="dname"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Username<font color="red">*</font></label>
                                <input type="text" class="form-control" id="username"
                                       placeholder="">
                            </div>
                        </div>
                        <div class="mb-4 pr-5 row">
                            <div class="col-lg-6">
                                <label class="form-label">Password<font color="red">*</font></label>
                                <input type="password" class="form-control" id="password"
                                       placeholder="">
                            </div>
                            <div class="col-lg-6">
                                <label class="form-label">Confirm Password</label>
                                <input type="password" class="form-control" id="cpassword"
                                       placeholder="">
                            </div>
                        </div>
                        <button type="button" class="btn mt-4 float-end pry-btn mr-5" onclick="completeOffline();">SIGN UP</button>
                    </form>
            </div>
        </div>
    </div>
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<script>
    //var url = "http://localhost:8080";
    //var wordpressUrl = "http://localhost:8099";
    var url = "https://proinsight-reconservice.herokuapp.com";
    var wordpressUrl = "https://proinsight-lmsservice.herokuapp.com";
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const id = urlParams.get('id');

    //ON-READY FUNCTION
    (function() {
        console.log("id "+id);
        //Calling the User Details API
        $.ajax({
            type: "GET",
            beforeSend: function(request) {
                request.setRequestHeader("Access-Control-Allow-Headers", "X-Requested-With, content-type");
                request.setRequestHeader("Access-Control-Allow-Origin", "*");
            },
            url: url + "/users/getCand/" + id,
            contentType: "application/json",
            dataType: 'json',
            success: function(result){
                console.log("Here "+result.paymentType);
                if(result.paymentType == 1){
                    document.getElementById("withoutPay").style.display = "block";
                    document.getElementById("withPay").style.display = "none";
                    document.getElementById("fname").value = result.fname;
                    document.getElementById("lname").value = result.lname;
                    document.getElementById("email").value = result.email;
                    document.getElementById("fname").text = result.fname;
                    document.getElementById("lname").text = result.lname;
                    document.getElementById("email").text = result.email;
                }else{
                    document.getElementById("withoutPay").style.display = "none";
                    document.getElementById("withPay").style.display = "block";
                }
            },
            error: function(result){
                console.log("Here "+result.statusText);
            }
        })
    })();

    //Method to complete offline registration
    function completeOffline(){
        var pass = document.getElementById("password").value;
        var cpass = document.getElementById("cpassword").value;
        if(pass != cpass){
            swal({
                title: "Password Mismatch",
                text: "Password Is Not Consistent!",
                icon: "error",
            });
        }else {
            $.ajax({
    	        type: "POST",
       	        beforeSend: function(request) {
       	            request.setRequestHeader("Access-Control-Allow-Headers", "X-Requested-With, content-type");
       	        },
                url: wordpressUrl + "/wpusers/add",
                contentType: "application/json",
                dataType: 'json',
                data: JSON.stringify({
                    displayName : document.getElementById("dname").value,
                    userLogin : document.getElementById("username").value,
                    userEmail : document.getElementById("email").value,
                    //first_name : document.getElementById("fname").value,
                    //last_name : document.getElementById("lname").value,
                    userNicename : document.getElementById("nname").value,
                    userPass : pass/*,
                    meta: JSON.stringify({
                        nickname: document.getElementById("nname").value,
                        first_name : document.getElementById("fname").value,
                        last_name : document.getElementById("lname").value,
                        full_name: document.getElementById("fname").value + " " + document.getElementById("lname").value
                    })*/
                }),
                success: function(result){
                    swal({
                        title: result['status'],
                        text: result['message'],
                        icon: "success",
                    })
                    .then(() => {
                        completeOfflineHelper();
                    });
                },
                error: function(result){
                    console.log(result.responseText);
                    var json = $.parseJSON(result.responseText);
                    swal({
                        title: json.status,
                        text: json.message,
                        icon: "error",
                    });
                }
            })
        }
    }

    //Method to help complete offline registation reconciliation
    function completeOfflineHelper(){
        $.ajax({
    	    type: "POST",
       	    beforeSend: function(request) {
       	        request.setRequestHeader("Access-Control-Allow-Headers", "X-Requested-With, content-type");
       	    },
            url: url + "/users/completeOfflineCandidate",
            contentType: "application/json",
            dataType: 'json',
            data: JSON.stringify({
                id : id,
                fname : document.getElementById("fname").value,
                lname : document.getElementById("lname").value,
                email : document.getElementById("email").value,
                paymentType : 1
            }),
            success: function(result){
                console.log(result.statusText);
                location.reload();
            },
            error: function(result){
                console.log(result.responseText);
            }
        })
    }
</script>


</body>
</html>